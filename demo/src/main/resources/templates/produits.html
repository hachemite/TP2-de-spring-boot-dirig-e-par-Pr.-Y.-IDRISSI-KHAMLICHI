<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security5">
<head>
    <meta charset="UTF-8">
    <title>Gestion de Pharmacie - Produits</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
</head>
<body>

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center">
        <h1>Liste des Produits</h1>
        <div>
            <span class="me-3">
                Bonjour, <strong sec:authentication="name">Utilisateur</strong>
            </span>
            <form th:action="@{/logout}" method="post" class="d-inline">
                <button type="submit" class="btn btn-outline-danger">Déconnexion</button>
            </form>
        </div>
    </div>
    <div sec:authorize="hasAnyRole('ADMIN', 'PHARMACIEN')" class="my-3">
        <a th:href="@{/produits/new}" class="btn btn-primary">Ajouter un Produit</a>
    </div>

    <table class="table table-striped table-hover">
        <thead class="table-dark">
        <tr>
            <th>ID</th>
            <th>Nom</th>
            <th>Prix</th>
            <th>Catégorie</th>
            <th>Fournisseur</th>
            <th>Tags</th>
            <th sec:authorize="hasAnyRole('ADMIN', 'PHARMACIEN')">Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="produit : ${produits}">
            <td th:text="${produit.id}">1</td>
            <td th:text="${produit.nom}">Amoxicilline 500mg</td>
            <td th:text="${#numbers.formatCurrency(produit.prix)}">45.00</td>
            <td th:text="${produit.categorieNom}">Antibiotique</td>

            <td th:text="${produit.fournisseurNom}">PharmaMaroc</td>

            <td>
                    <span th:each="libelle : ${produit.tagLibelles}"
                          th:text="${libelle}"
                          class="badge bg-secondary me-1">
                        Tag
                    </span>
            </td>

            <td sec:authorize="hasAnyRole('ADMIN', 'PHARMACIEN')">
                <a th:href="@{/produits/edit/{id}(id=${produit.id})}" class="btn btn-sm btn-warning">Modifier</a>
                <a th:href="@{/produits/delete/{id}(id=${produit.id})}" class="btn btn-sm btn-danger">Supprimer</a>
            </td>
        </tr>
        </tbody>
    </table>
</div>

</body>
</html>